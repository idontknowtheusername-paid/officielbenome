var e=Object.defineProperty,n=Object.defineProperties,t=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,i={}.hasOwnProperty,a={}.propertyIsEnumerable,r=(n,t,s)=>t in n?e(n,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[t]=s,o=(e,n)=>{for(var t in n||(n={}))i.call(n,t)&&r(e,t,n[t]);if(s)for(var t of s(n))a.call(n,t)&&r(e,t,n[t]);return e},l=(e,s)=>n(e,t(s)),c=(e,n,t)=>new Promise(((s,i)=>{var a=e=>{try{o(t.next(e))}catch(n){i(n)}},r=e=>{try{o(t.throw(e))}catch(n){i(n)}},o=e=>e.done?s(e.value):Promise.resolve(e.value).then(a,r);o((t=t.apply(e,n)).next())}));import{j as d}from"./ui-BkW4XaSf.js";import{r as g}from"./router-g3RhsYON.js";import{s as u,u as p,I as m,B as h,aj as x}from"./admin-CLRj9nsH.js";import{A as f}from"./messaging-Ng7fT9-p.js";const b=["Dakar","ThiÃ¨s","Saint-Louis","Kaolack","Ziguinchor","Touba","Mbour","Rufisque","Pikine","GuÃ©diawaye","Cotonou","Porto-Novo","Abomey-Calavi","Parakou","Djougou","Bohicon","Kandi","Lokossa","Ouidah","Natitingou","LomÃ©","SokodÃ©","Kara","KpalimÃ©","AtakpamÃ©","Bassar","TsÃ©viÃ©","AnÃ©ho","Dapaong","Mango","Abidjan","BouakÃ©","Daloa","Yamoussoukro","San-PÃ©dro","Korhogo","Man","Abengourou","Gagnoa","Anyama","Lagos","Kano","Ibadan","Abuja","Port Harcourt","Benin City","Maiduguri","Zaria","Aba","Jos"],v=["toyota","peugeot","renault","citroÃ«n","citroen","ford","volkswagen","vw","bmw","mercedes","audi","honda","nissan","hyundai","kia","dacia","opel","fiat","chevrolet","mazda","suzuki"];function y(e){if(!e||"string"!=typeof e)return{section:"marketplace",params:{sort:"popular"}};const n=e.trim(),t=n.toLowerCase(),s=t.normalize("NFD").replace(/[\u0300-\u036f]/g,""),i=s.replace(/[\s-]/g,""),a=b.find((e=>(e=>{const n=e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),t=n.replace(/[\s-]/g,"");return s.includes(n)||i.includes(t)})(e)));let r,o;const l=t.match(/(\d+[\.,]?\d*)\s*(k|m)?/gi)||[],c=e=>{const n=e.match(/(\d+[\.,]?\d*)\s*(k|m)?/i);if(!n)return null;const t=parseFloat(n[1].replace(",",".")),s=n[2]?"m"===n[2].toLowerCase()?1e6:1e3:1;return Math.round(t*s)};if(l.length>=2&&/entre|et|-/i.test(t)){const e=c(l[0]),n=c(l[1]);e&&n&&(r=Math.min(e,n),o=Math.max(e,n))}else/max|<=|<\s*/i.test(t)&&l[0]?o=c(l[0]):/min|>=|>\s*/i.test(t)&&l[0]?r=c(l[0]):1===l.length&&(o=c(l[0]));let d,g="marketplace";/\b(appartement|maison|terrain|studio|immobilier|villa|pi[eÃ¨]ces|mÂ²|m2)\b/i.test(t)?g="immobilier":/\b(voiture|auto|car|moto|scooter|camion|camionnette|vehicule|vÃ©hicule)\b/i.test(t)||v.some((e=>t.includes(e)))?g="automobile":/\b(plombier|electricien|Ã©lectricien|menage|mÃ©nage|jardinage|coiffure|rÃ©paration|reparation|d[eÃ©]m[eÃ©]nagement|cours|prof|service|informatique|evenementiel|Ã©vÃ©nementiel)\b/i.test(t)&&(g="services");const u=v.find((e=>t.includes(e)));u&&(d=u);const p={search:n,sort:"popular"};return a&&(p.location=a),r&&(p.minPrice=r+""),o&&(p.maxPrice=o+""),d&&"automobile"===g&&(p.brand=d),{section:g,params:p}}const w=({message:e="AIDA rÃ©flÃ©chit...",showDots:n=!0,className:t=""})=>d.jsxs("div",{className:"typing-indicator "+t,children:[d.jsx("div",{className:"typing-avatar",children:d.jsx(f,{size:"default",showStatus:!0})}),d.jsxs("div",{className:"typing-content",children:[d.jsx("div",{className:"typing-message",children:e}),n&&d.jsxs("div",{className:"typing-dots",children:[d.jsx("span",{className:"dot"}),d.jsx("span",{className:"dot"}),d.jsx("span",{className:"dot"})]})]}),d.jsx("style",{jsx:!0,children:"\n        .typing-indicator {\n          display: flex;\n          align-items: flex-start;\n          gap: 12px;\n          padding: 12px;\n          background: linear-gradient(135deg, #0e141b 0%, #1a1f2e 100%);\n          border: 1px solid #2d3748;\n          border-radius: 16px;\n          margin: 8px 0;\n          animation: slideIn 0.3s ease-out;\n        }\n        \n        .typing-avatar {\n          flex-shrink: 0;\n        }\n        \n        .typing-content {\n          flex: 1;\n          min-width: 0;\n        }\n        \n        .typing-message {\n          color: #e2e8f0;\n          font-size: 14px;\n          font-weight: 500;\n          margin-bottom: 4px;\n        }\n        \n        .typing-dots {\n          display: flex;\n          gap: 4px;\n          align-items: center;\n        }\n        \n        .dot {\n          width: 6px;\n          height: 6px;\n          border-radius: 50%;\n          background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);\n          animation: typing 1.4s infinite ease-in-out;\n        }\n        \n        .dot:nth-child(1) {\n          animation-delay: -0.32s;\n        }\n        \n        .dot:nth-child(2) {\n          animation-delay: -0.16s;\n        }\n        \n        @keyframes typing {\n          0%, 80%, 100% {\n            transform: scale(0.8);\n            opacity: 0.5;\n          }\n          40% {\n            transform: scale(1);\n            opacity: 1;\n          }\n        }\n        \n        @keyframes pulse {\n          0% {\n            transform: scale(1);\n            opacity: 0.3;\n          }\n          50% {\n            transform: scale(1.1);\n            opacity: 0.1;\n          }\n          100% {\n            transform: scale(1);\n            opacity: 0.3;\n          }\n        }\n        \n        @keyframes slideIn {\n          from {\n            opacity: 0;\n            transform: translateY(10px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n      "})]}),k=({duration:e=3e3,message:n="AIDA traite votre demande...",onComplete:t,className:s=""})=>{const[i,a]=g.useState(0),[r,o]=g.useState(!1);return g.useEffect((()=>{const n=Date.now(),s=setInterval((()=>{const i=Date.now()-n,r=Math.min(i/e*100,100);a(r),100>r||(o(!0),clearInterval(s),setTimeout((()=>{null==t||t()}),500))}),50);return()=>clearInterval(s)}),[e,t]),d.jsxs("div",{className:"progress-container "+s,children:[d.jsxs("div",{className:"progress-header",children:[d.jsx("div",{className:"progress-icon",children:"âš¡"}),d.jsx("div",{className:"progress-message",children:n})]}),d.jsxs("div",{className:"progress-bar-container",children:[d.jsx("div",{className:"progress-bar-fill",style:{width:i+"%"}}),d.jsx("div",{className:"progress-glow"})]}),d.jsxs("div",{className:"progress-percentage",children:[Math.round(i),"%"]}),d.jsx("style",{jsx:!0,children:"\n        .progress-container {\n          background: linear-gradient(135deg, #0e141b 0%, #1a1f2e 100%);\n          border: 1px solid #2d3748;\n          border-radius: 12px;\n          padding: 16px;\n          margin: 12px 0;\n          animation: slideIn 0.3s ease-out;\n        }\n        \n        .progress-header {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          margin-bottom: 12px;\n        }\n        \n        .progress-icon {\n          font-size: 18px;\n          animation: pulse 2s infinite;\n        }\n        \n        .progress-message {\n          color: #e2e8f0;\n          font-size: 14px;\n          font-weight: 500;\n        }\n        \n        .progress-bar-container {\n          position: relative;\n          height: 6px;\n          background: #2d3748;\n          border-radius: 3px;\n          overflow: hidden;\n          margin-bottom: 8px;\n        }\n        \n        .progress-bar-fill {\n          height: 100%;\n          background: linear-gradient(90deg, #3b82f6 0%, #1d4ed8 50%, #0ea5e9 100%);\n          border-radius: 3px;\n          transition: width 0.1s ease-out;\n          position: relative;\n        }\n        \n        .progress-glow {\n          position: absolute;\n          top: 0;\n          left: 0;\n          height: 100%;\n          width: 20px;\n          background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.3) 50%, transparent 100%);\n          animation: shimmer 2s infinite;\n        }\n        \n        .progress-percentage {\n          text-align: right;\n          color: #a0aec0;\n          font-size: 12px;\n          font-weight: 600;\n        }\n        \n        @keyframes pulse {\n          0%, 100% {\n            transform: scale(1);\n          }\n          50% {\n            transform: scale(1.1);\n          }\n        }\n        \n        @keyframes shimmer {\n          0% {\n            transform: translateX(-100%);\n          }\n          100% {\n            transform: translateX(400%);\n          }\n        }\n        \n        @keyframes slideIn {\n          from {\n            opacity: 0;\n            transform: translateY(10px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n      "})]})},j=({steps:e=[],currentStep:n=0,onStepComplete:t,className:s=""})=>{const[i,a]=g.useState([]),[r,o]=g.useState(null);return g.useEffect((()=>{if(n<e.length){o(e[n]);const s=setTimeout((()=>{a((e=>[...e,n])),null==t||t(n)}),e[n].duration||2e3);return()=>clearTimeout(s)}}),[n,e,t]),d.jsxs("div",{className:"advanced-thinking "+s,children:[d.jsxs("div",{className:"thinking-header",children:[d.jsx(f,{size:"default",showStatus:!0}),d.jsxs("div",{className:"thinking-title",children:[d.jsx("div",{className:"thinking-icon",children:"ğŸ§ "}),d.jsx("div",{className:"thinking-text",children:"AIDA analyse intelligemment..."})]})]}),d.jsx("div",{className:"thinking-steps",children:e.map(((e,t)=>d.jsxs("div",{className:`thinking-step ${t===n?"active":""} ${i.includes(t)?"completed":""}`,children:[d.jsx("div",{className:"step-indicator",children:i.includes(t)?d.jsx("div",{className:"step-check",children:"âœ“"}):t===n?d.jsxs("div",{className:"step-loading",children:[d.jsx("div",{className:"loading-dot"}),d.jsx("div",{className:"loading-dot"}),d.jsx("div",{className:"loading-dot"})]}):d.jsx("div",{className:"step-number",children:t+1})}),d.jsxs("div",{className:"step-content",children:[d.jsx("div",{className:"step-title",children:e.title}),t===n&&e.description&&d.jsx("div",{className:"step-description",children:e.description}),t===n&&e.progress&&d.jsx("div",{className:"step-progress",children:d.jsx("div",{className:"step-progress-bar",style:{width:e.progress+"%"}})})]})]},t)))}),d.jsx("style",{jsx:!0,children:"\n        .advanced-thinking {\n          background: linear-gradient(135deg, #0e141b 0%, #1a1f2e 100%);\n          border: 1px solid #2d3748;\n          border-radius: 16px;\n          padding: 20px;\n          margin: 12px 0;\n          animation: slideIn 0.4s ease-out;\n        }\n        \n        .thinking-header {\n          display: flex;\n          align-items: center;\n          gap: 12px;\n          margin-bottom: 16px;\n        }\n        \n        .thinking-title {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n        }\n        \n        .thinking-icon {\n          font-size: 20px;\n          animation: pulse 2s infinite;\n        }\n        \n        .thinking-text {\n          color: #e2e8f0;\n          font-size: 16px;\n          font-weight: 600;\n        }\n        \n        .thinking-steps {\n          display: flex;\n          flex-direction: column;\n          gap: 12px;\n        }\n        \n        .thinking-step {\n          display: flex;\n          align-items: flex-start;\n          gap: 12px;\n          padding: 12px;\n          border-radius: 12px;\n          transition: all 0.3s ease;\n        }\n        \n        .thinking-step.active {\n          background: rgba(59, 130, 246, 0.1);\n          border: 1px solid rgba(59, 130, 246, 0.3);\n        }\n        \n        .thinking-step.completed {\n          background: rgba(16, 185, 129, 0.1);\n          border: 1px solid rgba(16, 185, 129, 0.3);\n        }\n        \n        .step-indicator {\n          width: 24px;\n          height: 24px;\n          border-radius: 50%;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          flex-shrink: 0;\n        }\n        \n        .step-number {\n          width: 24px;\n          height: 24px;\n          border-radius: 50%;\n          background: #4a5568;\n          color: #a0aec0;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          font-size: 12px;\n          font-weight: 600;\n        }\n        \n        .step-check {\n          width: 24px;\n          height: 24px;\n          border-radius: 50%;\n          background: #10b981;\n          color: white;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          font-size: 14px;\n          font-weight: bold;\n        }\n        \n        .step-loading {\n          display: flex;\n          gap: 2px;\n        }\n        \n        .loading-dot {\n          width: 6px;\n          height: 6px;\n          border-radius: 50%;\n          background: #3b82f6;\n          animation: loadingDot 1.4s infinite ease-in-out;\n        }\n        \n        .loading-dot:nth-child(1) { animation-delay: -0.32s; }\n        .loading-dot:nth-child(2) { animation-delay: -0.16s; }\n        \n        .step-content {\n          flex: 1;\n          min-width: 0;\n        }\n        \n        .step-title {\n          color: #e2e8f0;\n          font-size: 14px;\n          font-weight: 500;\n          margin-bottom: 4px;\n        }\n        \n        .step-description {\n          color: #a0aec0;\n          font-size: 12px;\n          margin-bottom: 8px;\n        }\n        \n        .step-progress {\n          height: 4px;\n          background: #2d3748;\n          border-radius: 2px;\n          overflow: hidden;\n        }\n        \n        .step-progress-bar {\n          height: 100%;\n          background: linear-gradient(90deg, #3b82f6 0%, #1d4ed8 100%);\n          border-radius: 2px;\n          transition: width 0.3s ease;\n        }\n        \n        @keyframes slideIn {\n          from {\n            opacity: 0;\n            transform: translateY(10px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        \n        @keyframes pulse {\n          0%, 100% {\n            transform: scale(1);\n          }\n          50% {\n            transform: scale(1.1);\n          }\n        }\n        \n        @keyframes loadingDot {\n          0%, 80%, 100% {\n            transform: scale(0.8);\n            opacity: 0.5;\n          }\n          40% {\n            transform: scale(1);\n            opacity: 1;\n          }\n        }\n        \n        /* Responsive */\n        @media (max-width: 640px) {\n          .advanced-thinking {\n            padding: 16px;\n          }\n          \n          .thinking-steps {\n            gap: 8px;\n          }\n          \n          .thinking-step {\n            padding: 8px;\n          }\n        }\n      "})]})},S=({message:e,isUser:n=!1,showAvatar:t=!0,className:s=""})=>{const{role:i,content:a}=e;return d.jsxs("div",{className:`message-container ${n?"user-message":"assistant-message"} ${s}`,children:[t&&d.jsx("div",{className:"message-avatar",children:n?d.jsx("div",{className:"user-avatar",children:d.jsx("span",{children:"ğŸ‘¤"})}):d.jsx(f,{size:"default",showStatus:!1})}),d.jsxs("div",{className:"message-bubble",children:[d.jsx("div",{className:"message-content",children:a}),d.jsx("div",{className:"message-time",children:(new Date).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})})]}),d.jsx("style",{jsx:!0,children:"\n        .message-container {\n          display: flex;\n          gap: 12px;\n          align-items: flex-start;\n          margin: 12px 0;\n          animation: slideIn 0.3s ease-out;\n        }\n        \n        .user-message {\n          flex-direction: row-reverse;\n        }\n        \n        .message-avatar {\n          flex-shrink: 0;\n        }\n        \n        .user-avatar {\n          width: 32px;\n          height: 32px;\n          border-radius: 50%;\n          background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          font-size: 16px;\n          border: 2px solid #2563eb;\n        }\n        \n\n        \n        .message-bubble {\n          max-width: 75%;\n          position: relative;\n        }\n        \n        .user-message .message-bubble {\n          max-width: 75%;\n        }\n        \n        .assistant-message .message-bubble {\n          max-width: 85%;\n        }\n        \n        .message-content {\n          padding: 12px 16px;\n          border-radius: 18px;\n          white-space: pre-wrap;\n          word-wrap: break-word;\n          line-height: 1.5;\n          font-size: 14px;\n          position: relative;\n          overflow: hidden;\n        }\n        \n        .user-message .message-content {\n          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n          color: white;\n          border-bottom-right-radius: 4px;\n        }\n        \n        .assistant-message .message-content {\n          background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);\n          color: #e2e8f0;\n          border: 1px solid #4a5568;\n          border-bottom-left-radius: 4px;\n        }\n        \n        .message-time {\n          font-size: 11px;\n          color: #a0aec0;\n          margin-top: 4px;\n          text-align: right;\n          opacity: 0.7;\n        }\n        \n        .user-message .message-time {\n          text-align: left;\n        }\n        \n        @keyframes slideIn {\n          from {\n            opacity: 0;\n            transform: translateY(10px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        \n        @keyframes pulse {\n          0% {\n            transform: scale(1);\n            opacity: 0.3;\n          }\n          50% {\n            transform: scale(1.1);\n            opacity: 0.1;\n          }\n          100% {\n            transform: scale(1);\n            opacity: 0.3;\n          }\n        }\n        \n        /* Responsive */\n        @media (max-width: 640px) {\n          .message-bubble {\n            max-width: 85%;\n          }\n          \n          .user-message .message-bubble {\n            max-width: 85%;\n          }\n          \n          .assistant-message .message-bubble {\n            max-width: 90%;\n          }\n        }\n      "})]})},z=({suggestions:e=[],onSuggestionClick:n,className:t=""})=>d.jsxs("div",{className:"suggestions-container "+t,children:[d.jsx("div",{className:"suggestions-label",children:"ğŸ’¡ Suggestions rapides"}),d.jsx("div",{className:"suggestions-grid",children:e.map(((e,t)=>d.jsxs("button",{className:"suggestion-chip",onClick:()=>null==n?void 0:n(e),style:{animationDelay:.1*t+"s"},children:[d.jsx("span",{className:"chip-icon",children:e.icon||"ğŸ’¬"}),d.jsx("span",{className:"chip-text",children:e.text||e})]},t)))}),d.jsx("style",{jsx:!0,children:"\n        .suggestions-container {\n          margin: 16px 0;\n          animation: slideIn 0.4s ease-out;\n        }\n        \n        .suggestions-label {\n          font-size: 12px;\n          color: #a0aec0;\n          margin-bottom: 8px;\n          font-weight: 600;\n          text-transform: uppercase;\n          letter-spacing: 0.5px;\n        }\n        \n        .suggestions-grid {\n          display: flex;\n          flex-wrap: wrap;\n          gap: 8px;\n        }\n        \n        .suggestion-chip {\n          display: flex;\n          align-items: center;\n          gap: 6px;\n          padding: 8px 12px;\n          background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);\n          border: 1px solid #4a5568;\n          border-radius: 20px;\n          color: #e2e8f0;\n          font-size: 13px;\n          font-weight: 500;\n          cursor: pointer;\n          transition: all 0.2s ease;\n          animation: chipSlideIn 0.3s ease-out forwards;\n          opacity: 0;\n          transform: translateY(10px);\n        }\n        \n        .suggestion-chip:hover {\n          background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);\n          border-color: #3b82f6;\n          transform: translateY(-2px);\n          box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);\n        }\n        \n        .suggestion-chip:active {\n          transform: translateY(0);\n          box-shadow: 0 2px 6px rgba(102, 126, 234, 0.2);\n        }\n        \n        .chip-icon {\n          font-size: 14px;\n          opacity: 0.8;\n        }\n        \n        .chip-text {\n          white-space: nowrap;\n        }\n        \n        @keyframes chipSlideIn {\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        \n        @keyframes slideIn {\n          from {\n            opacity: 0;\n            transform: translateY(10px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        \n        /* Responsive */\n        @media (max-width: 640px) {\n          .suggestions-grid {\n            gap: 6px;\n          }\n          \n          .suggestion-chip {\n            padding: 6px 10px;\n            font-size: 12px;\n          }\n        }\n      "})]}),N=new class{constructor(){this.userContext=null,this.marketData=null,this.recommendations=[]}analyzeUserContext(e,n,t){return c(this,null,(function*(){try{const s={user:null,preferences:{},behavior:{},marketInsights:{}};if(e){const{data:n}=yield u.from("users").select("*").eq("id",e).single();s.user=n}return t&&t.length>0&&(s.behavior=this.analyzeSearchBehavior(t),s.preferences=this.extractUserPreferences(t)),s.currentPage=this.analyzeCurrentPage(n),s.marketInsights=yield this.getMarketInsights(),this.userContext=s,s}catch(s){return null}}))}analyzeSearchBehavior(e){var n;const t={categories:{},locations:{},priceRanges:{},frequency:e.length,lastSearch:null==(n=e[e.length-1])?void 0:n.timestamp};return e.forEach((e=>{e.category&&(t.categories[e.category]=(t.categories[e.category]||0)+1),e.location&&(t.locations[e.location]=(t.locations[e.location]||0)+1),e.priceRange&&(t.priceRanges[e.priceRange]=(t.priceRanges[e.priceRange]||0)+1)})),t}extractUserPreferences(e){const n={favoriteCategories:[],preferredLocations:[],budgetRange:null,searchPatterns:[]};if(e.length>0){const t={};e.forEach((e=>{e.category&&(t[e.category]=(t[e.category]||0)+1)})),n.favoriteCategories=Object.entries(t).sort((([,e],[,n])=>n-e)).slice(0,3).map((([e])=>e));const s={};e.forEach((e=>{e.location&&(s[e.location]=(s[e.location]||0)+1)})),n.preferredLocations=Object.entries(s).sort((([,e],[,n])=>n-e)).slice(0,3).map((([e])=>e))}return n}analyzeCurrentPage(e){const n={type:"unknown",context:{},opportunities:[]};return e&&(e.includes("/annonce/")?(n.type="listing_detail",n.context={listingId:e.split("/annonce/")[1],action:"viewing_listing"},n.opportunities=["suggest_similar_listings","suggest_contact_seller","suggest_related_categories"]):e.includes("/marketplace")?(n.type="marketplace",n.context={action:"browsing_marketplace"},n.opportunities=["suggest_popular_categories","suggest_trending_items","suggest_user_preferences"]):e.includes("/immobilier")&&(n.type="real_estate",n.context={action:"browsing_real_estate"},n.opportunities=["suggest_property_types","suggest_locations","suggest_price_ranges"])),n}getMarketInsights(){return c(this,null,(function*(){try{const e={trendingCategories:[],popularLocations:[],priceTrends:{},newListings:0},{data:n}=yield u.from("listings").select("category, created_at").gte("created_at",new Date(Date.now()-6048e5).toISOString()).eq("status","approved");if(n){const t={};n.forEach((e=>{t[e.category]=(t[e.category]||0)+1})),e.trendingCategories=Object.entries(t).sort((([,e],[,n])=>n-e)).slice(0,5).map((([e])=>e))}const{count:t}=yield u.from("listings").select("*",{count:"exact"}).gte("created_at",new Date(Date.now()-864e5).toISOString()).eq("status","approved");return e.newListings=t||0,e}catch(e){return{}}}))}generateRecommendations(e,n){return c(this,null,(function*(){try{const t={immediate:[],contextual:[],trending:[],personalized:[]};return n&&(t.immediate=yield this.getImmediateRecommendations(n)),(null==e?void 0:e.currentPage)&&(t.contextual=yield this.getContextualRecommendations(e.currentPage)),(null==e?void 0:e.marketInsights)&&(t.trending=this.getTrendingRecommendations(e.marketInsights)),(null==e?void 0:e.preferences)&&(t.personalized=yield this.getPersonalizedRecommendations(e.preferences)),this.recommendations=t,t}catch(t){return{}}}))}getImmediateRecommendations(e){return c(this,null,(function*(){const n=[],t=e.toLowerCase().split(" ");return(t.includes("immobilier")||t.includes("maison")||t.includes("appartement"))&&n.push({type:"category",value:"Immobilier Ã  Dakar",icon:"ğŸ "},{type:"category",value:"Terrains constructibles",icon:"ğŸ—ï¸"},{type:"category",value:"Appartements 2 chambres",icon:"ğŸ¢"}),(t.includes("voiture")||t.includes("auto")||t.includes("moto"))&&n.push({type:"category",value:"Voitures d'occasion",icon:"ğŸš—"},{type:"category",value:"Motos Ã©conomiques",icon:"ğŸï¸"},{type:"category",value:"PiÃ¨ces dÃ©tachÃ©es",icon:"ğŸ”§"}),n}))}getContextualRecommendations(e){return c(this,null,(function*(){const n=[];return"listing_detail"===e.type&&n.push({type:"action",value:"Contacter le vendeur",icon:"ğŸ“"},{type:"action",value:"Voir des annonces similaires",icon:"ğŸ”"},{type:"action",value:"Partager cette annonce",icon:"ğŸ“¤"}),"marketplace"===e.type&&n.push({type:"category",value:"Nouvelles annonces",icon:"ğŸ†•"},{type:"category",value:"Promotions",icon:"ğŸ·ï¸"},{type:"category",value:"Annonces populaires",icon:"ğŸ”¥"}),n}))}getTrendingRecommendations(e){const n=[];return e.trendingCategories&&e.trendingCategories.forEach((e=>{n.push({type:"trending",value:e+" (tendance)",icon:"ğŸ“ˆ"})})),e.newListings>0&&n.push({type:"info",value:e.newListings+" nouvelles annonces aujourd'hui",icon:"ğŸ†•"}),n}getPersonalizedRecommendations(e){return c(this,null,(function*(){const n=[];return e.favoriteCategories&&e.favoriteCategories.forEach((e=>{n.push({type:"personalized",value:"Nouveaux "+e,icon:"â­"})})),e.preferredLocations&&e.preferredLocations.forEach((e=>{n.push({type:"personalized",value:"Annonces Ã  "+e,icon:"ğŸ“"})})),n}))}getAdvancedThinkingSteps(e,n){var t;const s=[{title:"Analyse du contexte",description:"Ã‰tude de la page actuelle et de l'historique utilisateur",duration:1500,progress:0},{title:"Recherche d'informations",description:"Collecte de donnÃ©es pertinentes et insights du marchÃ©",duration:2e3,progress:0},{title:"GÃ©nÃ©ration de recommandations",description:"CrÃ©ation de suggestions personnalisÃ©es",duration:1800,progress:0},{title:"Optimisation de la rÃ©ponse",description:"Affinage et personnalisation du message",duration:1200,progress:0}];return"listing_detail"===(null==(t=null==e?void 0:e.currentPage)?void 0:t.type)&&s.splice(1,0,{title:"Analyse de l'annonce",description:"Ã‰tude des dÃ©tails et recherche d'alternatives",duration:1600,progress:0}),n&&n.includes("prix")&&s.splice(2,0,{title:"Analyse des prix",description:"Comparaison avec le marchÃ© et estimation",duration:1400,progress:0}),s}},C=Object.freeze(Object.defineProperty({__proto__:null,default:({pageContext:e={}})=>{if("/messages"===window.location.pathname)return null;const{user:n}=p(),[t,s]=g.useState(!1),[i,a]=g.useState(""),[r,u]=g.useState(!1),[f,b]=g.useState(""),[v,C]=g.useState([]),[I,A]=g.useState([]),[R,D]=g.useState(null),[_,P]=g.useState(!1),[T,M]=g.useState(!1),[E,L]=g.useState(!1),[O,B]=g.useState(!1),[q,V]=g.useState([]),[Y,W]=g.useState(0),[$,K]=g.useState(null),[U,F]=g.useState([]),J=g.useRef(null),X=g.useRef(null),H=g.useMemo((()=>o(o({path:window.location.pathname},"undefined"!=typeof window&&window.__MAXIMARKET_CONTEXT?window.__MAXIMARKET_CONTEXT:{}),e)),[e]);g.useEffect((()=>{const e=localStorage.getItem("chatbot_conversations");if(e)try{const n=JSON.parse(e);Array.isArray(n)&&A(n)}catch(n){}}),[]),g.useEffect((()=>{I.length>0&&localStorage.setItem("chatbot_conversations",JSON.stringify(I))}),[I]),g.useEffect((()=>{const e=()=>M(window.matchMedia("(max-width: 640px)").matches);return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),g.useEffect((()=>{t&&c(null,null,(function*(){try{const e=JSON.parse(localStorage.getItem("search_history")||"[]"),t=yield N.analyzeUserContext(null==n?void 0:n.id,window.location.pathname,e);if(K(t),t){const e=yield N.generateRecommendations(t,"");F(e)}}catch(e){}}))}),[t,null==n?void 0:n.id]);const G=(e,n)=>c(null,null,(function*(){var t,s,i,a,r,d,g,p,m;try{if((e.length>20||/\b(prix|marchÃ©|tendance|recommandation|suggestion|analyse|comparaison)\b/i.test(e))&&$){B(!0);const n=N.getAdvancedThinkingSteps($,e);V(n),W(0);for(let e=0;e<n.length;e++)W(e),yield new Promise((t=>setTimeout(t,n[e].duration)));const t=yield N.generateRecommendations($,e);F(t)}const i=/^(yo|salut|bonjour|hello|hi|hey|ciao|hola|bonsoir|bonne\s+nuit)$/i.test(e.trim()),a=/\b(appartement|maison|voiture|service|immobilier|auto|plombier|electricien|terrain|studio|villa|moto|scooter|camion|menage|jardinage|coiffure|reparation|demenagement|cours|prof|informatique|evenementiel)\b/i.test(e.toLowerCase()),r=/\d+\s*(k|m|xof|frs?)|(dakar|abidjan|lome|cotonou|thiÃ¨s|saint-louis|kaolack|ziguinchor|touba|mbour|rufisque|pikine|guediawaye)/i.test(e.toLowerCase());let d=null,g="",u=[];if(P(!1),i||!a&&!r||(d=y(e)),d){b("searching");const{section:e,params:n}=d,s={immobilier:"real_estate",automobile:"automobile",services:"services",marketplace:"marketplace"},i=l(o({},n),{category:s[e]||void 0,limit:3,page:0,status:"approved"});try{const e=yield x.getAllListings(i);(null==(t=null==e?void 0:e.data)?void 0:t.length)&&(u=e.data.slice(0,3).map((e=>({id:e.id,title:e.title,price:e.price}))),g+=`J'ai trouvÃ© ${e.data.length} rÃ©sultats. Voici quelques suggestions:\n`+u.map((e=>{var n;return`â€¢ ${e.title} â€” ${null!=(n=e.price)?n:""} XOF (ouvrir: /annonce/${e.id})`})).join("\n")+"\n\n",P(!0))}catch(h){}}O&&(B(!1),V([]),W(0)),b("processing"),C((e=>[...e,{role:"assistant",content:g}]));const p=n.length;let m="";null==(s=X.current)||s.abort();const f=new AbortController;X.current=f,yield function(e){return c(this,arguments,(function*(e,n={},t="mistral-small-latest",s,i){var a,r,o;const l=yield fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:e,context:n,model:t,stream:!0}),signal:i});if(!l.ok||!l.body){const e=yield l.json().catch((()=>({})));throw Error((null==e?void 0:e.error)||"Chat API error")}const c=l.body.getReader(),d=new TextDecoder;let g="",u="";for(;;){const{value:e,done:n}=yield c.read();if(n)break;g+=d.decode(e,{stream:!0});const t=g.split("\n");g=t.pop()||"";for(const i of t)if(i.startsWith("data: ")){const e=i.slice(6);if("[DONE]"===e)continue;try{const n=JSON.parse(e),t=(null==(o=null==(r=null==(a=null==n?void 0:n.choices)?void 0:a[0])?void 0:r.delta)?void 0:o.content)||"";t&&(u+=t,null==s||s(u))}catch(h){}}}}))}(n,l(o({},H),{intent:d}),void 0,(e=>{m=e;const n=g+m;C((e=>e.map(((e,t)=>t===p?l(o({},e),{content:n}):e))))}),f.signal),setTimeout((()=>{var e;return null==(e=J.current)?void 0:e.scrollTo({top:J.current.scrollHeight,behavior:"smooth"})}),50)}catch(h){if("AbortError"===(null==h?void 0:h.name));else{let e="Une erreur serveur est survenue cÃ´tÃ© assistant.";(null==(i=h.message)?void 0:i.includes("API configuration error"))?e="Erreur de configuration API. Veuillez contacter l'administrateur.":(null==(a=h.message)?void 0:a.includes("401"))||(null==(r=h.message)?void 0:r.includes("Unauthorized"))?e="Erreur d'authentification API. Veuillez rÃ©essayer plus tard.":(null==(d=h.message)?void 0:d.includes("429"))||(null==(g=h.message)?void 0:g.includes("Too Many Requests"))?e="Limite de requÃªtes atteinte. Veuillez rÃ©essayer dans quelques minutes.":((null==(p=h.message)?void 0:p.includes("500"))||(null==(m=h.message)?void 0:m.includes("Internal Server Error")))&&(e="Erreur serveur temporaire. Veuillez rÃ©essayer dans un instant.");const n="Bonjour. Je reste Ã  votre disposition pour la recherche et vos questions.",t=_?e+" Vous pouvez cliquer sur Â« Voir plus Â» pour ouvrir tous les rÃ©sultats, ou rÃ©essayer dans un instant.":e+" Veuillez rÃ©essayer dans un instant ou lancer la recherche complÃ¨te depuis le marketplace.";C((e=>[...e,{role:"assistant",content:n},{role:"assistant",content:t}]))}}finally{u(!1),b("")}})),Z=()=>c(null,null,(function*(){const e=i.trim();if(!e||r)return;if(0===v.length){const n=Date.now().toString();D(n),A((t=>[...t,{id:n,title:e.length>30?e.substring(0,30)+"...":e,date:(new Date).toLocaleDateString(),messages:[]}]))}const n=[...v,{role:"user",content:e}];C(n),a(""),u(!0),b("thinking"),yield G(e,n)})),Q=()=>{var e,n;try{null==(e=X.current)||e.abort()}catch(s){}if(v.length>0&&R){const e=(null==(n=v.find((e=>"user"===e.role)))?void 0:n.content)||"Nouvelle conversation",t=e.length>30?e.substring(0,30)+"...":e,s=I.map((e=>e.id===R?l(o({},e),{messages:v,title:t}):e));A(s)}const t=Date.now().toString();D(t),C([]),a(""),u(!1),setTimeout((()=>{var e;return null==(e=J.current)?void 0:e.scrollTo({top:0,behavior:"smooth"})}),50)},ee=()=>I.map((e=>{var n;return{id:e.id,title:e.title||"Conversation sans titre",date:e.date||new Date(e.id).toLocaleDateString(),messageCount:(null==(n=e.messages)?void 0:n.length)||0}})).slice(-10).reverse(),ne=()=>({userMessages:v.filter((e=>"user"===e.role)).length,assistantMessages:v.filter((e=>"assistant"===e.role)).length,totalMessages:v.length,sessionDuration:v.length>0?Math.floor((Date.now()-(new Date).getTime())/6e4):0}),te=(e,t={})=>{var s,i;switch(e){case"publish_listing":window.location.href="/creer-annonce";break;case"my_listings":n?window.location.href="/mes-annonces":C((e=>[...e,{role:"assistant",content:"Vous devez Ãªtre connectÃ© pour voir vos annonces. Connectez-vous d'abord."}]));break;case"contact_seller":(null==(s=H.listing)?void 0:s.sellerId)?window.location.href=`/annonce/${H.listing.id}#contact`:C((e=>[...e,{role:"assistant",content:"Informations de contact non disponibles pour cette annonce."}]));break;case"share_listing":if(null==(i=H.listing)?void 0:i.id){const e=`${window.location.origin}/annonce/${H.listing.id}`;navigator.share?navigator.share({title:H.listing.title||"Annonce MaxiMarket",url:e}):(navigator.clipboard.writeText(e),C((e=>[...e,{role:"assistant",content:"Lien copiÃ© dans le presse-papiers !"}])))}}};return d.jsxs("div",{children:[!t&&d.jsxs("button",{onClick:()=>s(!0),"aria-label":"Ouvrir le chat",style:{position:"fixed",bottom:"calc(16px + env(safe-area-inset-bottom, 0px))",right:"calc(16px + env(safe-area-inset-right, 0px))",zIndex:9999,width:"auto",height:48,padding:"0 14px",borderRadius:28,background:"linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)",color:"white",border:"none",boxShadow:"0 10px 30px rgba(59, 130, 246, 0.3)",display:"flex",alignItems:"center",gap:8,fontSize:"13px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:e=>{e.target.style.background="linear-gradient(135deg, #2563eb 0%, #1e40af 100%)",e.target.style.boxShadow="0 12px 35px rgba(59, 130, 246, 0.4)"},onMouseLeave:e=>{e.target.style.background="linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)",e.target.style.boxShadow="0 10px 30px rgba(59, 130, 246, 0.3)"},children:[d.jsx("span",{style:{fontSize:"18px",lineHeight:1},children:"ğŸ’¬"}),"Demander Ã  AIDA"]}),t&&d.jsxs(d.Fragment,{children:[d.jsx("div",{onClick:()=>{s(!1),L(!1)},style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:9998,background:"rgba(0,0,0,0.3)"}}),E&&d.jsx("div",{onClick:()=>L(!1),style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:9997,background:"transparent"}}),d.jsxs("div",{style:{position:"fixed",bottom:T?"calc(16px + env(safe-area-inset-bottom, 0px))":20,right:T?"calc(16px + env(safe-area-inset-right, 0px))":20,left:"auto",top:"auto",zIndex:9999,width:T?"80vw":420,maxWidth:"95vw",height:T?"90vw":560,maxHeight:"78vh",background:"#0b0f14",border:"1px solid #111827",borderRadius:16,display:"flex",flexDirection:"column",boxShadow:"0 18px 38px rgba(0,0,0,0.6)"},children:[d.jsxs("div",{style:{padding:"12px 14px",borderBottom:"1px solid #1f2937",display:"flex",justifyContent:"space-between",alignItems:"center",background:"#0e141b",position:T?"sticky":"static",top:0},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[d.jsxs("div",{style:{position:"relative"},children:[d.jsx("button",{onClick:()=>L(!E),style:{width:36,height:36,borderRadius:10,background:"linear-gradient(135deg,#111827,#0b0f14)",color:"#fff",display:"grid",placeItems:"center",border:"1px solid #1f2937",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:e=>e.target.style.background="linear-gradient(135deg,#1f2937,#111827)",onMouseLeave:e=>e.target.style.background="linear-gradient(135deg,#111827,#0b0f14)",children:E?d.jsxs("div",{style:{position:"relative",width:16,height:16,display:"flex",alignItems:"center",justifyContent:"center"},children:[d.jsx("div",{style:{position:"absolute",width:16,height:2,background:"#e5e7eb",borderRadius:1,transform:"rotate(45deg)",transition:"all 0.2s"}}),d.jsx("div",{style:{position:"absolute",width:16,height:2,background:"#e5e7eb",borderRadius:1,transform:"rotate(-45deg)",transition:"all 0.2s"}})]}):d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[d.jsx("div",{style:{width:16,height:2,background:"#e5e7eb",borderRadius:1}}),d.jsx("div",{style:{width:16,height:2,background:"#e5e7eb",borderRadius:1}}),d.jsx("div",{style:{width:16,height:2,background:"#e5e7eb",borderRadius:1}})]})}),E&&d.jsxs("div",{onClick:e=>e.stopPropagation(),style:{position:"absolute",top:"100%",left:0,width:280,background:"#0b0f14",border:"1px solid #1f2937",borderRadius:12,boxShadow:"0 10px 30px rgba(0,0,0,0.5)",zIndex:1e4,marginTop:8,padding:16},children:[d.jsxs("div",{style:{borderBottom:"1px solid #1f2937",paddingBottom:12,marginBottom:12},children:[d.jsx("div",{style:{fontWeight:700,color:"#e5e7eb",fontSize:14,marginBottom:4},children:"AIDA"}),d.jsxs("div",{style:{fontSize:12,color:"#9ca3af"},children:[ne().totalMessages," messages â€¢ ",ne().userMessages," recherches"]})]}),d.jsxs("div",{style:{marginBottom:16},children:[d.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8,fontWeight:600},children:"CONVERSATIONS RÃ‰CENTES"}),d.jsx("div",{style:{maxHeight:120,overflowY:"auto"},children:ee().length>0?ee().map(((e,n)=>d.jsx("button",{onClick:()=>{const n=I.find((n=>n.id===e.id));n&&(C(n.messages||[]),D(e.id),L(!1))},style:{width:"100%",padding:"8px 12px",background:"transparent",border:"none",color:"#e5e7eb",fontSize:12,textAlign:"left",borderRadius:6,cursor:"pointer",marginBottom:2,transition:"all 0.2s"},onMouseEnter:e=>e.target.style.background="#1f2937",onMouseLeave:e=>e.target.style.background="transparent",children:d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[d.jsx("div",{style:{width:4,height:4,borderRadius:"50%",background:"#6b7280"}}),d.jsxs("div",{style:{flex:1,overflow:"hidden"},children:[d.jsx("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontWeight:500},children:e.title}),d.jsxs("div",{style:{fontSize:10,color:"#9ca3af"},children:[e.date," â€¢ ",e.messageCount," messages"]})]})]})},e.id))):d.jsx("div",{style:{fontSize:12,color:"#6b7280",fontStyle:"italic"},children:"Aucune conversation rÃ©cente"})})]}),d.jsxs("div",{style:{borderTop:"1px solid #1f2937",paddingTop:12},children:[d.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8,fontWeight:600},children:"ACTIONS RAPIDES"}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[d.jsx("button",{onClick:()=>{te("publish_listing"),L(!1)},style:{width:"100%",padding:"6px 12px",background:"transparent",border:"1px solid #374151",color:"#e5e7eb",fontSize:12,borderRadius:6,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:e=>e.target.style.background="#1f2937",onMouseLeave:e=>e.target.style.background="transparent",children:"ğŸ“ Publier une annonce"}),n&&d.jsx("button",{onClick:()=>{te("my_listings"),L(!1)},style:{width:"100%",padding:"6px 12px",background:"transparent",border:"1px solid #374151",color:"#e5e7eb",fontSize:12,borderRadius:6,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:e=>e.target.style.background="#1f2937",onMouseLeave:e=>e.target.style.background="transparent",children:"ğŸ“‹ Mes annonces"}),d.jsx("button",{onClick:()=>{Q(),L(!1)},style:{width:"100%",padding:"6px 12px",background:"transparent",border:"1px solid #374151",color:"#e5e7eb",fontSize:12,borderRadius:6,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:e=>e.target.style.background="#1f2937",onMouseLeave:e=>e.target.style.background="transparent",children:"ğŸ†• Nouveau chat"})]})]})]})]}),d.jsx("div",{children:d.jsx("div",{style:{fontWeight:700,color:"#e5e7eb",fontSize:15},children:"AIDA"})})]}),d.jsxs("div",{style:{display:"flex",gap:6},children:[d.jsx("button",{onClick:Q,title:"Nouveau chat","aria-label":"Nouveau chat",style:{width:32,height:32,border:"1px solid #374151",background:"#0b0f14",color:"#e5e7eb",borderRadius:8,display:"grid",placeItems:"center",fontWeight:600,fontSize:16},children:"+"}),r&&d.jsx("button",{onClick:()=>{var e;return null==(e=X.current)?void 0:e.abort()},title:"ArrÃªter",style:{width:32,height:32,border:"1px solid #374151",background:"#0b0f14",color:"#e5e7eb",borderRadius:8,display:"grid",placeItems:"center",fontSize:12,fontWeight:600},children:"â¹"}),d.jsx("button",{onClick:()=>{s(!1),L(!1)},"aria-label":"Fermer",style:{width:32,height:32,border:"1px solid #374151",background:"#0b0f14",color:"#e5e7eb",borderRadius:8,display:"grid",placeItems:"center",fontSize:16,fontWeight:600},children:"Ã—"})]})]}),d.jsxs("div",{ref:J,style:{flex:1,overflowY:"auto",padding:14,paddingBottom:"calc(14px + env(safe-area-inset-bottom, 0px))"},children:[0===v.length&&!E&&d.jsxs("div",{style:{fontSize:14,color:"#9ca3af"},children:[d.jsx(z,{suggestions:[...(()=>{const e=[],n=v.filter((e=>"user"===e.role)).map((e=>e.content.toLowerCase())),t=n.some((e=>e.includes("immobilier")||e.includes("appartement")||e.includes("maison")||e.includes("terrain"))),s=n.some((e=>e.includes("voiture")||e.includes("auto")||e.includes("vÃ©hicule"))),i=n.some((e=>e.includes("service")||e.includes("plomberie")||e.includes("Ã©lectricitÃ©")));return t&&e.push({text:"Appartements 2 chambres Ã  Dakar",icon:"ğŸ "},{text:"Terrains constructibles",icon:"ğŸ—ï¸"}),s&&e.push({text:"Voitures d'occasion rÃ©centes",icon:"ğŸš—"},{text:"Motos Ã©conomiques",icon:"ğŸï¸"}),i&&e.push({text:"Services de nettoyage",icon:"ğŸ§¹"},{text:"RÃ©paration Ã©lectromÃ©nager",icon:"ğŸ”§"}),0===e.length&&e.push({text:"Immobilier Ã  Dakar",icon:"ğŸ "},{text:"Voitures < 3 000 000 XOF",icon:"ğŸš—"}),e.slice(0,3)})(),{text:"Publier une annonce",icon:"ğŸ“"},{text:"Services plomberie",icon:"ğŸ”§"},{text:n?"Voir mes annonces":"Se connecter",icon:n?"ğŸ“‹":"ğŸ”"}],onSuggestionClick:e=>{const n=e.text||e;"Publier une annonce"===n?te("publish_listing"):"Voir mes annonces"===n?te("my_listings"):"Se connecter"===n?window.location.href="/connexion":(a(n),setTimeout((()=>{const e=n.trim();if(e&&!r){if(0===v.length){const n=Date.now().toString();D(n),A((t=>[...t,{id:n,title:e.length>30?e.substring(0,30)+"...":e,date:(new Date).toLocaleDateString(),messages:[]}]))}const n=[...v,{role:"user",content:e}];C(n),a(""),u(!0),b("thinking"),G(e,n)}}),100))}}),H.listing&&!E&&d.jsxs("div",{style:{marginTop:15,paddingTop:15,borderTop:"1px solid #1f2937"},children:[d.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8},children:"Actions rapides :"}),d.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:[d.jsx("button",{onClick:()=>te("contact_seller"),style:{padding:"4px 8px",border:"1px solid #374151",borderRadius:6,background:"#0e141b",color:"#e5e7eb",fontSize:12,cursor:"pointer"},children:"Contacter le vendeur"}),d.jsx("button",{onClick:()=>te("share_listing"),style:{padding:"4px 8px",border:"1px solid #374151",borderRadius:6,background:"#0e141b",color:"#e5e7eb",fontSize:12,cursor:"pointer"},children:"Partager"})]})]})]}),v.map(((e,n)=>d.jsx(S,{message:e,isUser:"user"===e.role},n))),!r&&!E&&U&&Object.keys(U).length>0&&d.jsxs("div",{style:{marginTop:16},children:[d.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8,fontWeight:600},children:"ğŸ’¡ Suggestions intelligentes d'AIDA"}),Object.entries(U).map((([e,n])=>n.length>0&&d.jsxs("div",{style:{marginBottom:12},children:[d.jsxs("div",{style:{fontSize:11,color:"#9ca3af",marginBottom:6,textTransform:"uppercase"},children:["immediate"===e&&"Recommandations immÃ©diates","contextual"===e&&"Actions contextuelles","trending"===e&&"Tendances du marchÃ©","personalized"===e&&"PersonnalisÃ© pour vous"]}),d.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:n.slice(0,3).map(((e,n)=>d.jsxs("button",{onClick:()=>{const n=e.value||e.text||e;a(n),setTimeout((()=>{const e=n.trim();if(e&&!r){const n=[...v,{role:"user",content:e}];C(n),a(""),u(!0),b("thinking"),G(e,n)}}),100)},style:{padding:"6px 12px",border:"1px solid #374151",borderRadius:8,background:"linear-gradient(135deg, #1f2937, #111827)",color:"#e5e7eb",fontSize:12,cursor:"pointer",transition:"all 0.2s",display:"flex",alignItems:"center",gap:4},onMouseEnter:e=>e.target.style.background="linear-gradient(135deg, #374151, #1f2937)",onMouseLeave:e=>e.target.style.background="linear-gradient(135deg, #1f2937, #111827)",children:[d.jsx("span",{children:e.icon||"ğŸ’¬"}),d.jsx("span",{children:e.value||e.text||e})]},n)))})]},e)))]}),r&&d.jsxs("div",{style:{margin:"10px 0"},children:[O&&q.length>0?d.jsx(j,{steps:q,currentStep:Y,onStepComplete:e=>{}}):"thinking"===f?d.jsx(w,{message:"AIDA rÃ©flÃ©chit Ã  votre demande..."}):"searching"===f?d.jsx(k,{duration:2e3,message:"AIDA recherche des annonces..."}):null,"processing"===f&&d.jsx(w,{message:"AIDA rÃ©dige sa rÃ©ponse..."})]})]}),d.jsxs("div",{style:{display:"flex",gap:8,padding:12,paddingBottom:"calc(12px + env(safe-area-inset-bottom, 0px))",borderTop:"1px solid #1f2937",background:"#0e141b",borderBottomLeftRadius:16,borderBottomRightRadius:16},children:[d.jsx(m,{value:i,onChange:e=>a(e.target.value),onKeyDown:e=>{"Enter"===e.key&&Z()},placeholder:"Votre message...",style:{background:"#0b0f14",color:"#e5e7eb",borderColor:"#1f2937"}}),d.jsx(h,{onClick:Z,disabled:r||!i.trim(),style:{background:"#111827",border:"1px solid #1f2937"},children:"Envoyer"}),_&&d.jsx(h,{variant:"outline",onClick:()=>{var e,n,t,s,i;const a=y((null==(e=v.filter((e=>"user"===e.role)).slice(-1)[0])?void 0:e.content)||""),r=new URLSearchParams;(null==(n=null==a?void 0:a.params)?void 0:n.search)&&r.set("search",a.params.search),(null==(t=null==a?void 0:a.params)?void 0:t.minPrice)&&r.set("minPrice",a.params.minPrice),(null==(s=null==a?void 0:a.params)?void 0:s.maxPrice)&&r.set("maxPrice",a.params.maxPrice),(null==(i=null==a?void 0:a.params)?void 0:i.location)&&r.set("location",a.params.location),window.location.href="/marketplace?"+r.toString()},style:{border:"1px solid #374151",color:"#e5e7eb"},children:"Voir plus"})]})]})]})]})}},Symbol.toStringTag,{value:"Module"}));export{C,y as r};
